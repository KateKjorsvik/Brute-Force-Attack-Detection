swiftCopy code{
"properties": {
// Name and description of the detection rule
"displayName": "Brute-Force Attack Detection",
"description": "Detect and respond to brute-force attacks on web applications hosted on Microsoft Azure",
// Severity level of the alert generated by the rule
"severity": 2,
// KQL query used to detect brute-force attacks
"query": "AzureActivity\n| where OperationName == 'Microsoft.Web/sites/slots/config/authsettings/list/action'\n| where ActivityStatus == 'Succeeded'\n| where tostring(parse_json(RequestBody).properties.authSettings.properties.enabled) == 'False'\n| where tostring(parse_json(RequestBody).properties.authSettings.properties.unauthenticatedClientAction) == 'BlockRequest'\n| where tostring(parse_json(RequestBody).properties.authSettings.properties.tokenStoreEnabled) == 'True'\n| where tostring(parse_json(RequestBody).properties.authSettings.properties.clientAffinityEnabled) == 'True'\n| summarize count() by bin(TimeGenerated, 1h), RemoteIpAddress_s\n| where count_ > 5\n| project TimeGenerated, RemoteIpAddress_s, count_\n",
// Whether the detection rule is enabled or not
"enabled": true,
// MITRE ATT&CK tactics associated with the detection rule
"tactics": [
"Defense Evasion",
"Credential Access"
],
// Conditions that will trigger the detection rule
"triggers": [
{
// The type of trigger: Scheduled, Entity, etc.
"type": "Scheduled",
// The schedule for the trigger
"schedule": "*/5 * * * *",
// Whether the trigger is enabled or not
"state": "Enabled"
}
        ],
        "actions": [
            {
                "actionType": "BlockIpAddress",
                "duration": "PT1H",
                "reason": "Brute-force attack detected"
            },
            {
                "actionType": "Alert",
                "severity": 2,
                "description": "Brute-force attack detected"
            }
        ]
    }
}

